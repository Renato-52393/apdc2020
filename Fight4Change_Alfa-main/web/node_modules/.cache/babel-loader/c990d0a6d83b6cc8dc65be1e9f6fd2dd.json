{"ast":null,"code":"var _jsxFileName = \"/Users/goncalomoura/Documents/verFinal/Fight4Change_Alfa/web/src/Components/Maps/Details.js\",\n    _s = $RefreshSig$();\n\n/*global google*/\nimport React, { useState } from 'react';\nimport \"./map.css\";\nimport { MDBtn, MBtn } from './Button';\nimport { GoogleMap, Marker, InfoWindow, DirectionsRenderer } from \"@react-google-maps/api\";\nimport usePlacesAutocomplete, { getGeocode, getLatLng } from \"use-places-autocomplete\";\nimport { Combobox, ComboboxInput, ComboboxPopover, ComboboxList, ComboboxOption } from \"@reach/combobox\";\nimport \"@reach/combobox/styles.css\";\nimport { LocateMDBtn, LocateMBtn } from './LocateButton';\nimport { useHistory } from \"react-router-dom\";\nimport { Button } from '@material-ui/core';\nimport Modal from 'react-bootstrap/Modal';\nimport { BtnLinkRedirect, BtnRedirect } from './redirect';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nimport { Fragment as _Fragment } from \"react/jsx-dev-runtime\";\nconst mapContainerStyle = {\n  height: \"80vh\",\n  width: \"50%\"\n};\nconst center = {\n  lat: 38.660783,\n  lng: -9.205681\n};\n\nfunction CreateEvents() {\n  _s();\n\n  let history = useHistory();\n  const [eventsName, setEventsName] = useState();\n  const [date, setDate] = useState();\n  const [time, setTime] = useState();\n  const [origin, setOrigin] = useState();\n  const [description, setDescription] = useState();\n  const [show, setShow] = useState(false);\n\n  const handleClose = () => {\n    setShow(false);\n    let url = \"/home\";\n    history.push(url);\n  };\n\n  const handleOpen = () => {\n    console.log(\"entrei aqui\");\n    setShow(true);\n    console.log(show);\n  };\n\n  const [state, setState] = React.useState({\n    directions: null\n  });\n  /*\n    const handleChange = React.useCallback((e) => {\n      const value = e.target.value;\n      setState({\n          [e.target.name]: value\n      });\n      console.log(e.target.value)\n    })*/\n\n  const [markers, setMarkers] = useState([]);\n  const [selected, setSelected] = useState([]);\n  const coordinates = markers.map(p => ({\n    lat: p.lat,\n    lng: p.lng\n  }));\n  const coord = JSON.stringify(coordinates);\n\n  const handleContinue = e => {\n    e.preventDefault();\n    const request = {\n      method: 'POST',\n      headers: {\n        'Content-Type': 'application/json',\n        'Accept': 'application/json',\n        'Authorization': 'Bearer ' + localStorage.getItem(\"user\")\n      },\n      body: JSON.stringify({\n        eventsName: eventsName,\n        date: date,\n        origin: origin,\n        description: description,\n        time: time,\n        markers: coord\n      })\n    };\n    fetch('https://apdc-fasebeta.appspot.com/createEvent', request).then(response => {\n      console.log(request.headers);\n      console.log(\"mudei1\");\n      console.log(request.body);\n      console.log(\"response\" + response);\n\n      if (response.ok) {\n        console.log(\"Event successfully created alterado2!\");\n        setShow(true);\n        console.log(\"no continue: \" + show);\n      } else {\n        console.log(\"Something went wrong.\"); //  this.setShow(false);\n\n        console.log(show);\n        let url = \"/createEvent\";\n        history.push(url);\n      }\n    }).catch(error => console.error('Error', error));\n  };\n\n  var service = new google.maps.DirectionsService();\n  const onMapClick = React.useCallback(e => {\n    setMarkers(current => [...current, {\n      lat: e.latLng.lat(),\n      lng: e.latLng.lng()\n    }]);\n  }, []);\n  const onMarkerClick = React.useCallback(e => {\n    setSelected(current => [...current, {\n      lat: e.latLng.lat(),\n      lng: e.latLng.lng(),\n      active: true\n    }]);\n  }, []);\n  const mapRef = React.useRef();\n  const onMapLoad = React.useCallback(map => {\n    mapRef.current = map;\n  }, []);\n  const panTo = React.useCallback(({\n    lat,\n    lng\n  }) => {\n    mapRef.current.panTo({\n      lat,\n      lng\n    });\n    mapRef.current.setZoom(20);\n  }, []);\n  const {\n    ready,\n    value,\n    suggestions: {\n      status,\n      data\n    },\n    setValue,\n    clearSuggestions\n  } = usePlacesAutocomplete({\n    requestOptions: {\n      location: {\n        lat: () => 38.660783,\n        lng: () => -9.205681\n      },\n      radius: 100 * 1000\n    }\n  });\n\n  const handleInput = e => {\n    setValue(e.target.value);\n  };\n\n  const handleSelect = async address => {\n    setValue(address, false);\n    clearSuggestions();\n\n    try {\n      const results = await getGeocode({\n        address\n      });\n      const {\n        lat,\n        lng\n      } = await getLatLng(results[0]);\n      panTo({\n        lat,\n        lng\n      });\n      setMarkers(current => [...current, {\n        lat: lat,\n        lng: lng\n      }]);\n      const waypoints = markers.map(p => ({\n        location: {\n          lat: p.lat,\n          lng: p.lng\n        },\n        stopover: true\n      }));\n\n      if (waypoints.length >= 2) {\n        const origin = waypoints[0].location;\n        const destination = waypoints.pop().location;\n        service.route({\n          origin: origin,\n          destination: destination,\n          travelMode: google.maps.TravelMode.WALKING,\n          waypoints: waypoints\n        }, (result, status) => {\n          if (status === google.maps.DirectionsStatus.OK) {\n            setState({\n              directions: result\n            });\n          } else {\n            console.error(`error fetching directions ${result}`);\n          }\n        });\n      }\n    } catch (error) {\n      console.log(\"Error: \", error);\n    }\n  };\n\n  const onMarkerDragEnd = (e, index) => {\n    markers[index] = { ...markers[index],\n      lat: e.latLng.lat(),\n      lng: e.latLng.lng()\n    };\n    const waypoints = markers.map(p => ({\n      location: {\n        lat: p.lat,\n        lng: p.lng\n      },\n      stopover: true\n    }));\n\n    if (waypoints.length >= 2) {\n      const origin = waypoints[0].location;\n      const destination = waypoints.pop().location;\n      service.route({\n        origin: origin,\n        destination: destination,\n        travelMode: google.maps.TravelMode.WALKING,\n        waypoints: waypoints\n      }, (result, status) => {\n        if (status === google.maps.DirectionsStatus.OK) {\n          setState({\n            directions: result\n          });\n        } else {\n          console.error(`error fetching directions ${result}`);\n        }\n      });\n    }\n  };\n  /* const onMarkerClick = (e,index) => { \n     console.log(index);\n     markers[index] = {...markers[index],lat: e.latLng.lat(), lng:e.latLng.lng(),active:true}\n     console.log(markers[index].active)\n   };*/\n\n\n  const onInfoClose = (e, index) => {\n    selected[index] = { ...selected[index],\n      lat: selected[index].lat,\n      lng: selected[index].lng,\n      active: false\n    };\n  }; //const origin = markers[0];\n  //const destination = markers[markers.length-1];\n\n\n  const waypoints = markers.map(p => ({\n    location: {\n      lat: p.lat,\n      lng: p.lng\n    },\n    stopover: true\n  }));\n\n  if (waypoints.length >= 2) {\n    const origin = waypoints[0].location;\n    const destination = waypoints.pop().location;\n    service.route({\n      origin: origin,\n      destination: destination,\n      travelMode: google.maps.TravelMode.WALKING,\n      waypoints: waypoints\n    }, (result, status) => {\n      if (status === google.maps.DirectionsStatus.OK) {\n        setState({\n          directions: result\n        });\n      } else {\n        console.error(`error fetching directions ${result}`);\n      }\n    });\n  }\n\n  return /*#__PURE__*/_jsxDEV(_Fragment, {\n    children: [/*#__PURE__*/_jsxDEV(Modal, {\n      className: \"modal\",\n      show: show,\n      onHide: handleClose,\n      children: [/*#__PURE__*/_jsxDEV(Modal.Header, {\n        children: /*#__PURE__*/_jsxDEV(Modal.Title, {\n          children: \"Event successfully created!\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 313,\n          columnNumber: 15\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 312,\n        columnNumber: 13\n      }, this), /*#__PURE__*/_jsxDEV(Modal.Body, {}, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 315,\n        columnNumber: 13\n      }, this), /*#__PURE__*/_jsxDEV(Modal.Footer, {\n        children: /*#__PURE__*/_jsxDEV(Button, {\n          variant: \"primary\",\n          onClick: handleClose,\n          children: \"Close\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 317,\n          columnNumber: 15\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 316,\n        columnNumber: 13\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 311,\n      columnNumber: 9\n    }, this), /*#__PURE__*/_jsxDEV(LocateMDBtn, {\n      children: /*#__PURE__*/_jsxDEV(LocateMBtn, {\n        className: \"locate\",\n        onClick: () => {\n          navigator.geolocation.getCurrentPosition(position => {\n            panTo({\n              lat: position.coords.latitude,\n              lng: position.coords.longitude\n            });\n          }, () => null);\n        },\n        children: /*#__PURE__*/_jsxDEV(\"i\", {\n          className: \"far fa-compass fa-2x\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 337,\n          columnNumber: 11\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 323,\n        columnNumber: 9\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 322,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"originImg\",\n      children: /*#__PURE__*/_jsxDEV(\"i\", {\n        className: \"fas fa-map-marker-alt fa-2x\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 342,\n        columnNumber: 34\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 342,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"origin\",\n      children: /*#__PURE__*/_jsxDEV(Combobox, {\n        onSelect: handleSelect,\n        children: [/*#__PURE__*/_jsxDEV(ComboboxInput, {\n          value: value,\n          onChange: handleInput,\n          disabled: !ready,\n          placeholder: \"Location\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 345,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(ComboboxPopover, {\n          children: /*#__PURE__*/_jsxDEV(ComboboxList, {\n            children: status === \"OK\" && data.map(({\n              id,\n              description\n            }) => /*#__PURE__*/_jsxDEV(ComboboxOption, {\n              value: description\n            }, id, false, {\n              fileName: _jsxFileName,\n              lineNumber: 355,\n              columnNumber: 19\n            }, this))\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 352,\n            columnNumber: 13\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 351,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 344,\n        columnNumber: 9\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 343,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(GoogleMap, {\n      id: \"map\",\n      mapContainerStyle: mapContainerStyle,\n      zoom: 8,\n      center: center,\n      onClick: onMapClick,\n      onLoad: onMapLoad,\n      children: [markers.map((marker, index) => /*#__PURE__*/_jsxDEV(Marker, {\n        position: {\n          lat: marker.lat,\n          lng: marker.lng\n        },\n        draggable: true,\n        onDragEnd: e => onMarkerDragEnd(e, index),\n        onClick: e => onMarkerClick(e, index)\n      }, index, false, {\n        fileName: _jsxFileName,\n        lineNumber: 374,\n        columnNumber: 11\n      }, this)), selected.map((select, index) => select.active ? /*#__PURE__*/_jsxDEV(InfoWindow, {\n        position: {\n          lat: select.lat,\n          lng: select.lng\n        },\n        onCloseClick: e => onInfoClose(e, index),\n        children: /*#__PURE__*/_jsxDEV(\"div\", {\n          children: [/*#__PURE__*/_jsxDEV(\"h2\", {\n            children: [/*#__PURE__*/_jsxDEV(\"span\", {\n              role: \"img\",\n              \"aria-label\": \"bear\",\n              children: /*#__PURE__*/_jsxDEV(\"i\", {\n                className: \"fas fa-hands-helping\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 392,\n                columnNumber: 19\n              }, this)\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 391,\n              columnNumber: 17\n            }, this), \" \", \"Paragem na Rota\"]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 390,\n            columnNumber: 15\n          }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n            children: [\"Escolhido \", select.lat, \" , \", select.lng]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 396,\n            columnNumber: 15\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 389,\n          columnNumber: 13\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 385,\n        columnNumber: 11\n      }, this) : null), \";\", /*#__PURE__*/_jsxDEV(DirectionsRenderer, {\n        directions: state.directions,\n        options: {\n          suppressMarkers: true\n        }\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 401,\n        columnNumber: 13\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 364,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"form\", {\n      className: \"details\",\n      onSubmit: handleContinue,\n      children: [/*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"nameImg\",\n        children: /*#__PURE__*/_jsxDEV(\"i\", {\n          className: \"fas fa-signature fa-2x\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 413,\n          columnNumber: 34\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 413,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"name\",\n        children: /*#__PURE__*/_jsxDEV(\"input\", {\n          placeholder: \"Events Name\",\n          type: \"text\",\n          name: \"eventsName\",\n          noValidate: true,\n          onChange: e => setEventsName(e.target.value) // values = {values}\n\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 415,\n          columnNumber: 11\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 414,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"timeImg\",\n        children: /*#__PURE__*/_jsxDEV(\"i\", {\n          className: \"fas fa-hourglass-half fa-2x\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 424,\n          columnNumber: 34\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 424,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"time\",\n        children: /*#__PURE__*/_jsxDEV(\"input\", {\n          placeholder: \"Duration\",\n          type: \"time\",\n          name: \"time\",\n          noValidate: true,\n          onChange: e => setTime(e.target.value)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 426,\n          columnNumber: 11\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 425,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"OImg\",\n        children: /*#__PURE__*/_jsxDEV(\"i\", {\n          className: \"far fa-dot-circle fa-2x\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 434,\n          columnNumber: 31\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 434,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"orig\",\n        children: /*#__PURE__*/_jsxDEV(\"input\", {\n          placeholder: \"Event Location Beginning\",\n          type: \"text\",\n          name: \"origin\",\n          noValidate: true,\n          onChange: e => setOrigin(e.target.value)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 436,\n          columnNumber: 11\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 435,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"Ocalendar\",\n        children: /*#__PURE__*/_jsxDEV(\"i\", {\n          className: \"far fa-calendar-alt fa-2x\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 444,\n          columnNumber: 36\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 444,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"date\",\n        children: /*#__PURE__*/_jsxDEV(\"input\", {\n          placeholder: \"Event Date\",\n          type: \"datetime-local\",\n          name: \"date\",\n          noValidate: true,\n          onChange: e => setDate(e.target.value)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 446,\n          columnNumber: 11\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 445,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"DesImg\",\n        children: /*#__PURE__*/_jsxDEV(\"i\", {\n          className: \"fas fa-file-signature fa-2x\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 455,\n          columnNumber: 33\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 455,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"textArea\",\n        children: /*#__PURE__*/_jsxDEV(\"textarea\", {\n          name: \"description\",\n          placeholder: \"Event Descriprion\",\n          onChange: e => setDescription(e.target.value)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 457,\n          columnNumber: 11\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 456,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(MDBtn, {\n        children: /*#__PURE__*/_jsxDEV(MBtn, {\n          type: \"submit\",\n          onClick: handleOpen,\n          children: \"Create Event\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 464,\n          columnNumber: 11\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 463,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 412,\n      columnNumber: 7\n    }, this)]\n  }, void 0, true);\n}\n\n_s(CreateEvents, \"nQG2ucxdHyXutcZZsp+I9kCmnCc=\", false, function () {\n  return [useHistory, usePlacesAutocomplete];\n});\n\n_c = CreateEvents;\n;\nexport default CreateEvents;\n\nvar _c;\n\n$RefreshReg$(_c, \"CreateEvents\");","map":{"version":3,"sources":["/Users/goncalomoura/Documents/verFinal/Fight4Change_Alfa/web/src/Components/Maps/Details.js"],"names":["React","useState","MDBtn","MBtn","GoogleMap","Marker","InfoWindow","DirectionsRenderer","usePlacesAutocomplete","getGeocode","getLatLng","Combobox","ComboboxInput","ComboboxPopover","ComboboxList","ComboboxOption","LocateMDBtn","LocateMBtn","useHistory","Button","Modal","BtnLinkRedirect","BtnRedirect","mapContainerStyle","height","width","center","lat","lng","CreateEvents","history","eventsName","setEventsName","date","setDate","time","setTime","origin","setOrigin","description","setDescription","show","setShow","handleClose","url","push","handleOpen","console","log","state","setState","directions","markers","setMarkers","selected","setSelected","coordinates","map","p","coord","JSON","stringify","handleContinue","e","preventDefault","request","method","headers","localStorage","getItem","body","fetch","then","response","ok","catch","error","service","google","maps","DirectionsService","onMapClick","useCallback","current","latLng","onMarkerClick","active","mapRef","useRef","onMapLoad","panTo","setZoom","ready","value","suggestions","status","data","setValue","clearSuggestions","requestOptions","location","radius","handleInput","target","handleSelect","address","results","waypoints","stopover","length","destination","pop","route","travelMode","TravelMode","WALKING","result","DirectionsStatus","OK","onMarkerDragEnd","index","onInfoClose","navigator","geolocation","getCurrentPosition","position","coords","latitude","longitude","id","marker","select","suppressMarkers"],"mappings":";;;AAAA;AACA,OAAOA,KAAP,IAAcC,QAAd,QAA6B,OAA7B;AACA,OAAO,WAAP;AACA,SAASC,KAAT,EAAgBC,IAAhB,QAA4B,UAA5B;AACA,SAASC,SAAT,EAAoBC,MAApB,EAA4BC,UAA5B,EAAwCC,kBAAxC,QAAkE,wBAAlE;AACA,OAAOC,qBAAP,IAAgCC,UAAhC,EAA4CC,SAA5C,QAA6D,yBAA7D;AACA,SAASC,QAAT,EAAmBC,aAAnB,EAAkCC,eAAlC,EAAmDC,YAAnD,EAAiEC,cAAjE,QAAuF,iBAAvF;AACA,OAAO,4BAAP;AACA,SAASC,WAAT,EAAsBC,UAAtB,QAAwC,gBAAxC;AACA,SAASC,UAAT,QAA2B,kBAA3B;AAGA,SAASC,MAAT,QAAuB,mBAAvB;AACA,OAAOC,KAAP,MAAkB,uBAAlB;AACA,SAASC,eAAT,EAAyBC,WAAzB,QAA4C,YAA5C;;;AAMA,MAAMC,iBAAiB,GAAG;AACxBC,EAAAA,MAAM,EAAE,MADgB;AAExBC,EAAAA,KAAK,EAAE;AAFiB,CAA1B;AAKA,MAAMC,MAAM,GAAG;AACbC,EAAAA,GAAG,EAAE,SADQ;AAEbC,EAAAA,GAAG,EAAE,CAAC;AAFO,CAAf;;AAMA,SAASC,YAAT,GAAwB;AAAA;;AAEvB,MAAIC,OAAO,GAAGZ,UAAU,EAAxB;AACA,QAAK,CAACa,UAAD,EAAaC,aAAb,IAA8B/B,QAAQ,EAA3C;AACA,QAAK,CAACgC,IAAD,EAAOC,OAAP,IAAkBjC,QAAQ,EAA/B;AACA,QAAK,CAACkC,IAAD,EAAOC,OAAP,IAAkBnC,QAAQ,EAA/B;AACA,QAAK,CAACoC,MAAD,EAASC,SAAT,IAAsBrC,QAAQ,EAAnC;AACA,QAAK,CAACsC,WAAD,EAAcC,cAAd,IAAgCvC,QAAQ,EAA7C;AAGA,QAAK,CAACwC,IAAD,EAAMC,OAAN,IAAiBzC,QAAQ,CAAC,KAAD,CAA9B;;AAEA,QAAM0C,WAAW,GAAG,MAAM;AAACD,IAAAA,OAAO,CAAC,KAAD,CAAP;AAC5B,QAAIE,GAAG,GAAE,OAAT;AACCd,IAAAA,OAAO,CAACe,IAAR,CAAaD,GAAb;AAAmB,GAFnB;;AAIA,QAAME,UAAU,GAAC,MAAI;AAACC,IAAAA,OAAO,CAACC,GAAR,CAAY,aAAZ;AAA2BN,IAAAA,OAAO,CAAC,IAAD,CAAP;AAAeK,IAAAA,OAAO,CAACC,GAAR,CAAYP,IAAZ;AAAkB,GAAlF;;AAIC,QAAM,CAACQ,KAAD,EAAQC,QAAR,IAAoBlD,KAAK,CAACC,QAAN,CAAe;AAACkD,IAAAA,UAAU,EAAC;AAAZ,GAAf,CAA1B;AAEF;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AACE,QAAM,CAACC,OAAD,EAAUC,UAAV,IAAwBpD,QAAQ,CAAC,EAAD,CAAtC;AACA,QAAM,CAACqD,QAAD,EAAWC,WAAX,IAA0BtD,QAAQ,CAAC,EAAD,CAAxC;AAEA,QAAMuD,WAAW,GAAGJ,OAAO,CAACK,GAAR,CAAYC,CAAC,KAAI;AAAE/B,IAAAA,GAAG,EAAE+B,CAAC,CAAC/B,GAAT;AAAcC,IAAAA,GAAG,EAAE8B,CAAC,CAAC9B;AAArB,GAAJ,CAAb,CAApB;AACA,QAAM+B,KAAK,GAAGC,IAAI,CAACC,SAAL,CAAeL,WAAf,CAAd;;AAEA,QAAMM,cAAc,GAAGC,CAAC,IAAI;AAC1BA,IAAAA,CAAC,CAACC,cAAF;AACA,UAAMC,OAAO,GAAG;AACdC,MAAAA,MAAM,EAAE,MADM;AAEdC,MAAAA,OAAO,EAAE;AACP,wBAAgB,kBADT;AAEP,kBAAU,kBAFH;AAGP,yBAAiB,YAAYC,YAAY,CAACC,OAAb,CAAqB,MAArB;AAHtB,OAFK;AAOdC,MAAAA,IAAI,EAAEV,IAAI,CAACC,SAAL,CAAe;AACnB9B,QAAAA,UAAU,EAAEA,UADO;AAEnBE,QAAAA,IAAI,EAACA,IAFc;AAGnBI,QAAAA,MAAM,EAAEA,MAHW;AAInBE,QAAAA,WAAW,EAACA,WAJO;AAKnBJ,QAAAA,IAAI,EAAEA,IALa;AAMnBiB,QAAAA,OAAO,EAACO;AANW,OAAf;AAPQ,KAAhB;AAgBAY,IAAAA,KAAK,CAAC,+CAAD,EAAkDN,OAAlD,CAAL,CACCO,IADD,CACOC,QAAQ,IAAI;AAEf1B,MAAAA,OAAO,CAACC,GAAR,CAAYiB,OAAO,CAACE,OAApB;AACApB,MAAAA,OAAO,CAACC,GAAR,CAAY,QAAZ;AACAD,MAAAA,OAAO,CAACC,GAAR,CAAYiB,OAAO,CAACK,IAApB;AACAvB,MAAAA,OAAO,CAACC,GAAR,CAAY,aAAayB,QAAzB;;AACA,UAAIA,QAAQ,CAACC,EAAb,EAAiB;AACf3B,QAAAA,OAAO,CAACC,GAAR,CAAY,uCAAZ;AACAN,QAAAA,OAAO,CAAC,IAAD,CAAP;AACAK,QAAAA,OAAO,CAACC,GAAR,CAAY,kBAAmBP,IAA/B;AACD,OAJD,MAKK;AACHM,QAAAA,OAAO,CAACC,GAAR,CAAY,uBAAZ,EADG,CAEL;;AACED,QAAAA,OAAO,CAACC,GAAR,CAAYP,IAAZ;AACA,YAAIG,GAAG,GAAE,cAAT;AACAd,QAAAA,OAAO,CAACe,IAAR,CAAaD,GAAb;AAED;AACF,KApBH,EAoBK+B,KApBL,CAoBWC,KAAK,IAAI7B,OAAO,CAAC6B,KAAR,CAAc,OAAd,EAAuBA,KAAvB,CApBpB;AAqBD,GAvCD;;AA6CA,MAAIC,OAAO,GAAG,IAAIC,MAAM,CAACC,IAAP,CAAYC,iBAAhB,EAAd;AAIA,QAAMC,UAAU,GAAGjF,KAAK,CAACkF,WAAN,CAAmBnB,CAAD,IAAO;AAC1CV,IAAAA,UAAU,CAAE8B,OAAD,IAAa,CACtB,GAAGA,OADmB,EAEtB;AACExD,MAAAA,GAAG,EAAEoC,CAAC,CAACqB,MAAF,CAASzD,GAAT,EADP;AAEEC,MAAAA,GAAG,EAAEmC,CAAC,CAACqB,MAAF,CAASxD,GAAT;AAFP,KAFsB,CAAd,CAAV;AAQD,GATkB,EAShB,EATgB,CAAnB;AAWA,QAAMyD,aAAa,GAAGrF,KAAK,CAACkF,WAAN,CAAmBnB,CAAD,IAAO;AAC7CR,IAAAA,WAAW,CAAE4B,OAAD,IAAa,CACvB,GAAGA,OADoB,EACX;AAEVxD,MAAAA,GAAG,EAAEoC,CAAC,CAACqB,MAAF,CAASzD,GAAT,EAFK;AAGVC,MAAAA,GAAG,EAAEmC,CAAC,CAACqB,MAAF,CAASxD,GAAT,EAHK;AAIV0D,MAAAA,MAAM,EAAE;AAJE,KADW,CAAd,CAAX;AAUD,GAXqB,EAWpB,EAXoB,CAAtB;AAcA,QAAMC,MAAM,GAAGvF,KAAK,CAACwF,MAAN,EAAf;AACA,QAAMC,SAAS,GAAGzF,KAAK,CAACkF,WAAN,CAAmBzB,GAAD,IAAS;AAC3C8B,IAAAA,MAAM,CAACJ,OAAP,GAAiB1B,GAAjB;AACD,GAFiB,EAEf,EAFe,CAAlB;AAIA,QAAMiC,KAAK,GAAG1F,KAAK,CAACkF,WAAN,CAAkB,CAAC;AAAEvD,IAAAA,GAAF;AAAOC,IAAAA;AAAP,GAAD,KAAkB;AAChD2D,IAAAA,MAAM,CAACJ,OAAP,CAAeO,KAAf,CAAqB;AAAE/D,MAAAA,GAAF;AAAOC,MAAAA;AAAP,KAArB;AACA2D,IAAAA,MAAM,CAACJ,OAAP,CAAeQ,OAAf,CAAuB,EAAvB;AACD,GAHa,EAGX,EAHW,CAAd;AAKA,QAAM;AACJC,IAAAA,KADI;AAEJC,IAAAA,KAFI;AAGJC,IAAAA,WAAW,EAAE;AAAEC,MAAAA,MAAF;AAAUC,MAAAA;AAAV,KAHT;AAIJC,IAAAA,QAJI;AAKJC,IAAAA;AALI,MAMF1F,qBAAqB,CAAC;AACxB2F,IAAAA,cAAc,EAAE;AACdC,MAAAA,QAAQ,EAAE;AAAEzE,QAAAA,GAAG,EAAE,MAAM,SAAb;AAAwBC,QAAAA,GAAG,EAAE,MAAM,CAAC;AAApC,OADI;AAEdyE,MAAAA,MAAM,EAAE,MAAM;AAFA;AADQ,GAAD,CANzB;;AAaA,QAAMC,WAAW,GAAIvC,CAAD,IAAO;AACzBkC,IAAAA,QAAQ,CAAClC,CAAC,CAACwC,MAAF,CAASV,KAAV,CAAR;AACD,GAFD;;AAIA,QAAMW,YAAY,GAAG,MAAOC,OAAP,IAAmB;AACtCR,IAAAA,QAAQ,CAACQ,OAAD,EAAU,KAAV,CAAR;AACAP,IAAAA,gBAAgB;;AAEhB,QAAI;AACF,YAAMQ,OAAO,GAAG,MAAMjG,UAAU,CAAC;AAAEgG,QAAAA;AAAF,OAAD,CAAhC;AAEA,YAAM;AAAE9E,QAAAA,GAAF;AAAOC,QAAAA;AAAP,UAAe,MAAMlB,SAAS,CAACgG,OAAO,CAAC,CAAD,CAAR,CAApC;AACAhB,MAAAA,KAAK,CAAC;AAAE/D,QAAAA,GAAF;AAAOC,QAAAA;AAAP,OAAD,CAAL;AACAyB,MAAAA,UAAU,CAAE8B,OAAD,IAAa,CACtB,GAAGA,OADmB,EAEtB;AACExD,QAAAA,GAAG,EAAEA,GADP;AAEEC,QAAAA,GAAG,EAAEA;AAFP,OAFsB,CAAd,CAAV;AAQA,YAAM+E,SAAS,GAAGvD,OAAO,CAACK,GAAR,CAAYC,CAAC,KAAK;AAClC0C,QAAAA,QAAQ,EAAE;AAAEzE,UAAAA,GAAG,EAAE+B,CAAC,CAAC/B,GAAT;AAAcC,UAAAA,GAAG,EAAE8B,CAAC,CAAC9B;AAArB,SADwB;AAElCgF,QAAAA,QAAQ,EAAE;AAFwB,OAAL,CAAb,CAAlB;;AAMA,UAAID,SAAS,CAACE,MAAV,IAAoB,CAAxB,EAA2B;AACzB,cAAMxE,MAAM,GAAGsE,SAAS,CAAC,CAAD,CAAT,CAAaP,QAA5B;AACA,cAAMU,WAAW,GAAGH,SAAS,CAACI,GAAV,GAAgBX,QAApC;AAGAvB,QAAAA,OAAO,CAACmC,KAAR,CAEE;AACE3E,UAAAA,MAAM,EAAEA,MADV;AAEEyE,UAAAA,WAAW,EAAEA,WAFf;AAGEG,UAAAA,UAAU,EAAEnC,MAAM,CAACC,IAAP,CAAYmC,UAAZ,CAAuBC,OAHrC;AAIER,UAAAA,SAAS,EAAEA;AAJb,SAFF,EAQE,CAACS,MAAD,EAASrB,MAAT,KAAoB;AAClB,cAAIA,MAAM,KAAKjB,MAAM,CAACC,IAAP,CAAYsC,gBAAZ,CAA6BC,EAA5C,EAAgD;AAC9CpE,YAAAA,QAAQ,CAAC;AACPC,cAAAA,UAAU,EAAEiE;AADL,aAAD,CAAR;AAGD,WAJD,MAIO;AACLrE,YAAAA,OAAO,CAAC6B,KAAR,CAAe,6BAA4BwC,MAAO,EAAlD;AACD;AACF,SAhBH;AAmBD;AAEF,KA7CD,CA6CE,OAAOxC,KAAP,EAAc;AACd7B,MAAAA,OAAO,CAACC,GAAR,CAAY,SAAZ,EAAuB4B,KAAvB;AACD;AACF,GApDD;;AAsDA,QAAM2C,eAAe,GAAG,CAACxD,CAAD,EAAIyD,KAAJ,KAAc;AAEpCpE,IAAAA,OAAO,CAACoE,KAAD,CAAP,GAAiB,EAAE,GAAGpE,OAAO,CAACoE,KAAD,CAAZ;AAAqB7F,MAAAA,GAAG,EAAEoC,CAAC,CAACqB,MAAF,CAASzD,GAAT,EAA1B;AAA0CC,MAAAA,GAAG,EAAEmC,CAAC,CAACqB,MAAF,CAASxD,GAAT;AAA/C,KAAjB;AAEA,UAAM+E,SAAS,GAAGvD,OAAO,CAACK,GAAR,CAAYC,CAAC,KAAK;AAClC0C,MAAAA,QAAQ,EAAE;AAAEzE,QAAAA,GAAG,EAAE+B,CAAC,CAAC/B,GAAT;AAAcC,QAAAA,GAAG,EAAE8B,CAAC,CAAC9B;AAArB,OADwB;AAElCgF,MAAAA,QAAQ,EAAE;AAFwB,KAAL,CAAb,CAAlB;;AAMA,QAAID,SAAS,CAACE,MAAV,IAAoB,CAAxB,EAA2B;AACzB,YAAMxE,MAAM,GAAGsE,SAAS,CAAC,CAAD,CAAT,CAAaP,QAA5B;AACA,YAAMU,WAAW,GAAGH,SAAS,CAACI,GAAV,GAAgBX,QAApC;AACAvB,MAAAA,OAAO,CAACmC,KAAR,CACE;AACE3E,QAAAA,MAAM,EAAEA,MADV;AAEEyE,QAAAA,WAAW,EAAEA,WAFf;AAGEG,QAAAA,UAAU,EAAEnC,MAAM,CAACC,IAAP,CAAYmC,UAAZ,CAAuBC,OAHrC;AAIER,QAAAA,SAAS,EAAEA;AAJb,OADF,EAOE,CAACS,MAAD,EAASrB,MAAT,KAAoB;AAClB,YAAIA,MAAM,KAAKjB,MAAM,CAACC,IAAP,CAAYsC,gBAAZ,CAA6BC,EAA5C,EAAgD;AAE9CpE,UAAAA,QAAQ,CAAC;AACPC,YAAAA,UAAU,EAAEiE;AADL,WAAD,CAAR;AAGD,SALD,MAKO;AACLrE,UAAAA,OAAO,CAAC6B,KAAR,CAAe,6BAA4BwC,MAAO,EAAlD;AACD;AACF,OAhBH;AAmBD;AAIF,GApCD;AAqCA;AACF;AACA;AACA;AACA;;;AACE,QAAMK,WAAW,GAAG,CAAC1D,CAAD,EAAIyD,KAAJ,KAAc;AAChClE,IAAAA,QAAQ,CAACkE,KAAD,CAAR,GAAkB,EAAE,GAAGlE,QAAQ,CAACkE,KAAD,CAAb;AAAsB7F,MAAAA,GAAG,EAAE2B,QAAQ,CAACkE,KAAD,CAAR,CAAgB7F,GAA3C;AAAgDC,MAAAA,GAAG,EAAE0B,QAAQ,CAACkE,KAAD,CAAR,CAAgB5F,GAArE;AAA0E0D,MAAAA,MAAM,EAAE;AAAlF,KAAlB;AACD,GAFD,CAzOsB,CAgPtB;AACA;;;AAGA,QAAMqB,SAAS,GAAGvD,OAAO,CAACK,GAAR,CAAYC,CAAC,KAAK;AAClC0C,IAAAA,QAAQ,EAAE;AAAEzE,MAAAA,GAAG,EAAE+B,CAAC,CAAC/B,GAAT;AAAcC,MAAAA,GAAG,EAAE8B,CAAC,CAAC9B;AAArB,KADwB;AAElCgF,IAAAA,QAAQ,EAAE;AAFwB,GAAL,CAAb,CAAlB;;AAMA,MAAID,SAAS,CAACE,MAAV,IAAoB,CAAxB,EAA2B;AACzB,UAAMxE,MAAM,GAAGsE,SAAS,CAAC,CAAD,CAAT,CAAaP,QAA5B;AACA,UAAMU,WAAW,GAAGH,SAAS,CAACI,GAAV,GAAgBX,QAApC;AAEAvB,IAAAA,OAAO,CAACmC,KAAR,CAEE;AACE3E,MAAAA,MAAM,EAAEA,MADV;AAEEyE,MAAAA,WAAW,EAAEA,WAFf;AAGEG,MAAAA,UAAU,EAAEnC,MAAM,CAACC,IAAP,CAAYmC,UAAZ,CAAuBC,OAHrC;AAIER,MAAAA,SAAS,EAAEA;AAJb,KAFF,EAQE,CAACS,MAAD,EAASrB,MAAT,KAAoB;AAClB,UAAIA,MAAM,KAAKjB,MAAM,CAACC,IAAP,CAAYsC,gBAAZ,CAA6BC,EAA5C,EAAgD;AAE9CpE,QAAAA,QAAQ,CAAC;AACPC,UAAAA,UAAU,EAAEiE;AADL,SAAD,CAAR;AAGD,OALD,MAKO;AACLrE,QAAAA,OAAO,CAAC6B,KAAR,CAAe,6BAA4BwC,MAAO,EAAlD;AACD;AACF,KAjBH;AAoBD;;AAED,sBAEE;AAAA,4BACI,QAAC,KAAD;AAAO,MAAA,SAAS,EAAC,OAAjB;AAAyB,MAAA,IAAI,EAAE3E,IAA/B;AAAqC,MAAA,MAAM,EAAEE,WAA7C;AAAA,8BACI,QAAC,KAAD,CAAO,MAAP;AAAA,+BACE,QAAC,KAAD,CAAO,KAAP;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AADF;AAAA;AAAA;AAAA;AAAA,cADJ,eAII,QAAC,KAAD,CAAO,IAAP;AAAA;AAAA;AAAA;AAAA,cAJJ,eAKI,QAAC,KAAD,CAAO,MAAP;AAAA,+BACE,QAAC,MAAD;AAAQ,UAAA,OAAO,EAAC,SAAhB;AAA0B,UAAA,OAAO,EAAEA,WAAnC;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AADF;AAAA;AAAA;AAAA;AAAA,cALJ;AAAA;AAAA;AAAA;AAAA;AAAA,YADJ,eAYE,QAAC,WAAD;AAAA,6BACE,QAAC,UAAD;AACE,QAAA,SAAS,EAAC,QADZ;AAEE,QAAA,OAAO,EAAE,MAAM;AACb+E,UAAAA,SAAS,CAACC,WAAV,CAAsBC,kBAAtB,CACGC,QAAD,IAAc;AACZnC,YAAAA,KAAK,CAAC;AACJ/D,cAAAA,GAAG,EAAEkG,QAAQ,CAACC,MAAT,CAAgBC,QADjB;AAEJnG,cAAAA,GAAG,EAAEiG,QAAQ,CAACC,MAAT,CAAgBE;AAFjB,aAAD,CAAL;AAID,WANH,EAOE,MAAM,IAPR;AASD,SAZH;AAAA,+BAcE;AAAG,UAAA,SAAS,EAAC;AAAb;AAAA;AAAA;AAAA;AAAA;AAdF;AAAA;AAAA;AAAA;AAAA;AADF;AAAA;AAAA;AAAA;AAAA,YAZF,eAgCE;AAAK,MAAA,SAAS,EAAC,WAAf;AAAA,6BAA2B;AAAG,QAAA,SAAS,EAAC;AAAb;AAAA;AAAA;AAAA;AAAA;AAA3B;AAAA;AAAA;AAAA;AAAA,YAhCF,eAiCE;AAAK,MAAA,SAAS,EAAC,QAAf;AAAA,6BACE,QAAC,QAAD;AAAU,QAAA,QAAQ,EAAExB,YAApB;AAAA,gCACE,QAAC,aAAD;AACE,UAAA,KAAK,EAAEX,KADT;AAEE,UAAA,QAAQ,EAAES,WAFZ;AAGE,UAAA,QAAQ,EAAE,CAACV,KAHb;AAIE,UAAA,WAAW,EAAC;AAJd;AAAA;AAAA;AAAA;AAAA,gBADF,eAOE,QAAC,eAAD;AAAA,iCACE,QAAC,YAAD;AAAA,sBACGG,MAAM,KAAK,IAAX,IACCC,IAAI,CAACvC,GAAL,CAAS,CAAC;AAAEwE,cAAAA,EAAF;AAAM1F,cAAAA;AAAN,aAAD,kBACP,QAAC,cAAD;AAAyB,cAAA,KAAK,EAAEA;AAAhC,eAAqB0F,EAArB;AAAA;AAAA;AAAA;AAAA,oBADF;AAFJ;AAAA;AAAA;AAAA;AAAA;AADF;AAAA;AAAA;AAAA;AAAA,gBAPF;AAAA;AAAA;AAAA;AAAA;AAAA;AADF;AAAA;AAAA;AAAA;AAAA,YAjCF,eAsDE,QAAC,SAAD;AACE,MAAA,EAAE,EAAC,KADL;AAEE,MAAA,iBAAiB,EAAE1G,iBAFrB;AAGE,MAAA,IAAI,EAAE,CAHR;AAIE,MAAA,MAAM,EAAEG,MAJV;AAKE,MAAA,OAAO,EAAEuD,UALX;AAME,MAAA,MAAM,EAAEQ,SANV;AAAA,iBASGrC,OAAO,CAACK,GAAR,CAAY,CAACyE,MAAD,EAASV,KAAT,kBACX,QAAC,MAAD;AAEE,QAAA,QAAQ,EAAE;AAAE7F,UAAAA,GAAG,EAAEuG,MAAM,CAACvG,GAAd;AAAmBC,UAAAA,GAAG,EAAEsG,MAAM,CAACtG;AAA/B,SAFZ;AAGE,QAAA,SAAS,EAAE,IAHb;AAIE,QAAA,SAAS,EAAGmC,CAAD,IAAOwD,eAAe,CAACxD,CAAD,EAAIyD,KAAJ,CAJnC;AAKE,QAAA,OAAO,EAAGzD,CAAD,IAAOsB,aAAa,CAACtB,CAAD,EAAIyD,KAAJ;AAL/B,SACOA,KADP;AAAA;AAAA;AAAA;AAAA,cADD,CATH,EAmBGlE,QAAQ,CAACG,GAAT,CAAa,CAAC0E,MAAD,EAASX,KAAT,KAAoBW,MAAM,CAAC7C,MAAP,gBAEhC,QAAC,UAAD;AACE,QAAA,QAAQ,EAAE;AAAE3D,UAAAA,GAAG,EAAEwG,MAAM,CAACxG,GAAd;AAAmBC,UAAAA,GAAG,EAAEuG,MAAM,CAACvG;AAA/B,SADZ;AAEE,QAAA,YAAY,EAAGmC,CAAD,IAAO0D,WAAW,CAAC1D,CAAD,EAAIyD,KAAJ,CAFlC;AAAA,+BAIE;AAAA,kCACE;AAAA,oCACE;AAAM,cAAA,IAAI,EAAC,KAAX;AAAiB,4BAAW,MAA5B;AAAA,qCACE;AAAG,gBAAA,SAAS,EAAC;AAAb;AAAA;AAAA;AAAA;AAAA;AADF;AAAA;AAAA;AAAA;AAAA,oBADF,EAGU,GAHV;AAAA;AAAA;AAAA;AAAA;AAAA,kBADF,eAOE;AAAA,qCAAcW,MAAM,CAACxG,GAArB,SAA6BwG,MAAM,CAACvG,GAApC;AAAA;AAAA;AAAA;AAAA;AAAA,kBAPF;AAAA;AAAA;AAAA;AAAA;AAAA;AAJF;AAAA;AAAA;AAAA;AAAA,cAFgC,GAgB9B,IAhBH,CAnBH,oBAqCM,QAAC,kBAAD;AAAoB,QAAA,UAAU,EAAEqB,KAAK,CAACE,UAAtC;AAAmD,QAAA,OAAO,EAAE;AAE1DiF,UAAAA,eAAe,EAAE;AAFyC;AAA5D;AAAA;AAAA;AAAA;AAAA,cArCN;AAAA;AAAA;AAAA;AAAA;AAAA,YAtDF,eAsGE;AAAM,MAAA,SAAS,EAAC,SAAhB;AAA0B,MAAA,QAAQ,EAAEtE,cAApC;AAAA,8BACE;AAAK,QAAA,SAAS,EAAC,SAAf;AAAA,+BAAyB;AAAG,UAAA,SAAS,EAAC;AAAb;AAAA;AAAA;AAAA;AAAA;AAAzB;AAAA;AAAA;AAAA;AAAA,cADF,eAEE;AAAK,QAAA,SAAS,EAAC,MAAf;AAAA,+BACE;AACE,UAAA,WAAW,EAAC,aADd;AAEE,UAAA,IAAI,EAAC,MAFP;AAGE,UAAA,IAAI,EAAC,YAHP;AAIE,UAAA,UAAU,MAJZ;AAKE,UAAA,QAAQ,EAAEC,CAAC,IAAE/B,aAAa,CAAC+B,CAAC,CAACwC,MAAF,CAASV,KAAV,CAL5B,CAMA;;AANA;AAAA;AAAA;AAAA;AAAA;AADF;AAAA;AAAA;AAAA;AAAA,cAFF,eAYE;AAAK,QAAA,SAAS,EAAC,SAAf;AAAA,+BAAyB;AAAG,UAAA,SAAS,EAAC;AAAb;AAAA;AAAA;AAAA;AAAA;AAAzB;AAAA;AAAA;AAAA;AAAA,cAZF,eAaE;AAAK,QAAA,SAAS,EAAC,MAAf;AAAA,+BACE;AACE,UAAA,WAAW,EAAC,UADd;AAEE,UAAA,IAAI,EAAC,MAFP;AAGE,UAAA,IAAI,EAAC,MAHP;AAIE,UAAA,UAAU,MAJZ;AAKE,UAAA,QAAQ,EAAE9B,CAAC,IAAI3B,OAAO,CAAC2B,CAAC,CAACwC,MAAF,CAASV,KAAV;AALxB;AAAA;AAAA;AAAA;AAAA;AADF;AAAA;AAAA;AAAA;AAAA,cAbF,eAsBE;AAAK,QAAA,SAAS,EAAC,MAAf;AAAA,+BAAsB;AAAG,UAAA,SAAS,EAAC;AAAb;AAAA;AAAA;AAAA;AAAA;AAAtB;AAAA;AAAA;AAAA;AAAA,cAtBF,eAuBE;AAAK,QAAA,SAAS,EAAC,MAAf;AAAA,+BACE;AACE,UAAA,WAAW,EAAC,0BADd;AAEE,UAAA,IAAI,EAAC,MAFP;AAGE,UAAA,IAAI,EAAC,QAHP;AAIE,UAAA,UAAU,MAJZ;AAKE,UAAA,QAAQ,EAAE9B,CAAC,IAAIzB,SAAS,CAACyB,CAAC,CAACwC,MAAF,CAASV,KAAV;AAL1B;AAAA;AAAA;AAAA;AAAA;AADF;AAAA;AAAA;AAAA;AAAA,cAvBF,eAgCE;AAAK,QAAA,SAAS,EAAC,WAAf;AAAA,+BAA2B;AAAG,UAAA,SAAS,EAAC;AAAb;AAAA;AAAA;AAAA;AAAA;AAA3B;AAAA;AAAA;AAAA;AAAA,cAhCF,eAiCE;AAAK,QAAA,SAAS,EAAC,MAAf;AAAA,+BACE;AACE,UAAA,WAAW,EAAC,YADd;AAEE,UAAA,IAAI,EAAC,gBAFP;AAGE,UAAA,IAAI,EAAC,MAHP;AAIE,UAAA,UAAU,MAJZ;AAKE,UAAA,QAAQ,EAAE9B,CAAC,IAAI7B,OAAO,CAAC6B,CAAC,CAACwC,MAAF,CAASV,KAAV;AALxB;AAAA;AAAA;AAAA;AAAA;AADF;AAAA;AAAA;AAAA;AAAA,cAjCF,eA2CE;AAAK,QAAA,SAAS,EAAC,QAAf;AAAA,+BAAwB;AAAG,UAAA,SAAS,EAAC;AAAb;AAAA;AAAA;AAAA;AAAA;AAAxB;AAAA;AAAA;AAAA;AAAA,cA3CF,eA4CE;AAAK,QAAA,SAAS,EAAC,UAAf;AAAA,+BACE;AACE,UAAA,IAAI,EAAC,aADP;AAEE,UAAA,WAAW,EAAC,mBAFd;AAGE,UAAA,QAAQ,EAAE9B,CAAC,IAAIvB,cAAc,CAACuB,CAAC,CAACwC,MAAF,CAASV,KAAV;AAH/B;AAAA;AAAA;AAAA;AAAA;AADF;AAAA;AAAA;AAAA;AAAA,cA5CF,eAmDE,QAAC,KAAD;AAAA,+BACE,QAAC,IAAD;AAAM,UAAA,IAAI,EAAC,QAAX;AAAqB,UAAA,OAAO,EAAE/C,UAA9B;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AADF;AAAA;AAAA;AAAA;AAAA,cAnDF;AAAA;AAAA;AAAA;AAAA;AAAA,YAtGF;AAAA,kBAFF;AAsKD;;GA1bQjB,Y;UAEMX,U,EA4HTV,qB;;;KA9HGqB,Y;AA0bR;AAED,eAAeA,YAAf","sourcesContent":["/*global google*/\nimport React,{useState} from 'react'\nimport \"./map.css\";\nimport { MDBtn, MBtn } from './Button'\nimport { GoogleMap, Marker, InfoWindow, DirectionsRenderer } from \"@react-google-maps/api\";\nimport usePlacesAutocomplete, { getGeocode, getLatLng } from \"use-places-autocomplete\";\nimport { Combobox, ComboboxInput, ComboboxPopover, ComboboxList, ComboboxOption } from \"@reach/combobox\";\nimport \"@reach/combobox/styles.css\";\nimport { LocateMDBtn, LocateMBtn } from './LocateButton'\nimport { useHistory } from \"react-router-dom\";\n\n\nimport { Button } from '@material-ui/core';\nimport Modal from 'react-bootstrap/Modal'\nimport { BtnLinkRedirect,BtnRedirect } from './redirect';\n\n\n\n\n\nconst mapContainerStyle = {\n  height: \"80vh\",\n  width: \"50%\",\n};\n\nconst center = {\n  lat: 38.660783,\n  lng: -9.205681,\n};\n\n\nfunction CreateEvents() {\n\n let history = useHistory();\n const[eventsName, setEventsName] = useState();\n const[date, setDate] = useState();\n const[time, setTime] = useState();\n const[origin, setOrigin] = useState();\n const[description, setDescription] = useState();\n\n\n const[show,setShow] = useState(false);\n\n const handleClose = () => {setShow(false);  \nlet url =\"/home\";\n history.push(url);}\n\n const handleOpen=()=>{console.log(\"entrei aqui\");setShow(true); console.log(show)}\n\n \n\n  const [state, setState] = React.useState({directions:null});\n\n/*\n  const handleChange = React.useCallback((e) => {\n    const value = e.target.value;\n    setState({\n        [e.target.name]: value\n    });\n    console.log(e.target.value)\n  })*/\n  const [markers, setMarkers] = useState([]);\n  const [selected, setSelected] = useState([]);\n\n  const coordinates = markers.map(p=>( { lat: p.lat, lng: p.lng }));\n  const coord = JSON.stringify(coordinates);\n\n  const handleContinue = e => {\n    e.preventDefault();\n    const request = {\n      method: 'POST',\n      headers: {\n        'Content-Type': 'application/json',\n        'Accept': 'application/json',\n        'Authorization': 'Bearer ' + localStorage.getItem(\"user\") \n      },\n      body: JSON.stringify({\n        eventsName: eventsName,\n        date:date,\n        origin: origin,\n        description:description,\n        time: time,\n        markers:coord\n      })\n    };\n    fetch('https://apdc-fasebeta.appspot.com/createEvent', request)\n    .then( response => {\n     \n        console.log(request.headers)\n        console.log(\"mudei1\")\n        console.log(request.body)\n        console.log(\"response\" + response)\n        if (response.ok) {\n          console.log(\"Event successfully created alterado2!\");\n          setShow(true);\n          console.log(\"no continue: \" +  show);          \n        }\n        else {\n          console.log(\"Something went wrong.\");\n        //  this.setShow(false);\n          console.log(show);\n          let url =\"/createEvent\";\n          history.push(url);\n\n        }\n      }).catch(error => console.error('Error', error))\n  };\n\n\n\n\n \n  var service = new google.maps.DirectionsService();\n\n  \n\n  const onMapClick = React.useCallback((e) => {\n    setMarkers((current) => [\n      ...current,\n      {\n        lat: e.latLng.lat(),\n        lng: e.latLng.lng(),\n\n      },\n    ]);\n  }, []);\n\n  const onMarkerClick = React.useCallback((e) => {\n    setSelected((current) => [\n      ...current, {\n\n        lat: e.latLng.lat(),\n        lng: e.latLng.lng(),\n        active: true,\n      }\n    ])\n\n\n  },[])\n\n\n  const mapRef = React.useRef();\n  const onMapLoad = React.useCallback((map) => {\n    mapRef.current = map;\n  }, []);\n\n  const panTo = React.useCallback(({ lat, lng }) => {\n    mapRef.current.panTo({ lat, lng });\n    mapRef.current.setZoom(20);\n  }, []);\n\n  const {\n    ready,\n    value,\n    suggestions: { status, data },\n    setValue,\n    clearSuggestions,\n  } = usePlacesAutocomplete({\n    requestOptions: {\n      location: { lat: () => 38.660783, lng: () => -9.205681 },\n      radius: 100 * 1000,\n    },\n  });\n\n  const handleInput = (e) => {\n    setValue(e.target.value);\n  };\n\n  const handleSelect = async (address) => {\n    setValue(address, false);\n    clearSuggestions();\n\n    try {\n      const results = await getGeocode({ address });\n      \n      const { lat, lng } = await getLatLng(results[0]);\n      panTo({ lat, lng });\n      setMarkers((current) => [\n        ...current,\n        {\n          lat: lat,\n          lng: lng,\n\n        },\n      ]);\n      const waypoints = markers.map(p => ({\n        location: { lat: p.lat, lng: p.lng },\n        stopover: true\n      }))\n    \n      \n      if (waypoints.length >= 2) {\n        const origin = waypoints[0].location;\n        const destination = waypoints.pop().location;\n        \n    \n        service.route(\n    \n          {\n            origin: origin,\n            destination: destination,\n            travelMode: google.maps.TravelMode.WALKING,\n            waypoints: waypoints\n          },\n          (result, status) => {\n            if (status === google.maps.DirectionsStatus.OK) {\n              setState({\n                directions: result\n              }); \n            } else {\n              console.error(`error fetching directions ${result}`);\n            }\n          }\n    \n        )\n      }\n     \n    } catch (error) {\n      console.log(\"Error: \", error);\n    }\n  };\n\n  const onMarkerDragEnd = (e, index) => {\n   \n    markers[index] = { ...markers[index], lat: e.latLng.lat(), lng: e.latLng.lng() }\n\n    const waypoints = markers.map(p => ({\n      location: { lat: p.lat, lng: p.lng },\n      stopover: true\n    }))\n  \n    \n    if (waypoints.length >= 2) {\n      const origin = waypoints[0].location;\n      const destination = waypoints.pop().location;\n      service.route(\n        {\n          origin: origin,\n          destination: destination,\n          travelMode: google.maps.TravelMode.WALKING,\n          waypoints: waypoints\n        },\n        (result, status) => {\n          if (status === google.maps.DirectionsStatus.OK) {\n            \n            setState({\n              directions: result\n            });\n          } else {\n            console.error(`error fetching directions ${result}`);\n          }\n        }\n  \n      )\n    }\n  \n\n\n  };\n  /* const onMarkerClick = (e,index) => { \n     console.log(index);\n     markers[index] = {...markers[index],lat: e.latLng.lat(), lng:e.latLng.lng(),active:true}\n     console.log(markers[index].active)\n   };*/\n  const onInfoClose = (e, index) => {\n    selected[index] = { ...selected[index], lat: selected[index].lat, lng: selected[index].lng, active: false }\n  }\n\n  \n\n\n  //const origin = markers[0];\n  //const destination = markers[markers.length-1];\n\n\n  const waypoints = markers.map(p => ({\n    location: { lat: p.lat, lng: p.lng },\n    stopover: true\n  }))\n\n \n  if (waypoints.length >= 2) {\n    const origin = waypoints[0].location;\n    const destination = waypoints.pop().location;\n\n    service.route(\n\n      {\n        origin: origin,\n        destination: destination,\n        travelMode: google.maps.TravelMode.WALKING,\n        waypoints: waypoints\n      },\n      (result, status) => {\n        if (status === google.maps.DirectionsStatus.OK) {\n          \n          setState({\n            directions: result\n          });\n        } else {\n          console.error(`error fetching directions ${result}`);\n        }\n      }\n\n    )\n  }\n\n  return (\n\n    <>\n        <Modal className=\"modal\" show={show} onHide={handleClose}>\n            <Modal.Header>\n              <Modal.Title>Event successfully created!</Modal.Title>\n            </Modal.Header>\n            <Modal.Body></Modal.Body>\n            <Modal.Footer>\n              <Button variant=\"primary\" onClick={handleClose}>\n                Close\n              </Button>\n            </Modal.Footer>\n          </Modal>\n      <LocateMDBtn>\n        <LocateMBtn\n          className=\"locate\"\n          onClick={() => {\n            navigator.geolocation.getCurrentPosition(\n              (position) => {\n                panTo({\n                  lat: position.coords.latitude,\n                  lng: position.coords.longitude,\n                });\n              },\n              () => null\n            );\n          }}\n        >\n          <i className=\"far fa-compass fa-2x\"></i>\n        </LocateMBtn>\n      </LocateMDBtn>\n\n\n      <div className=\"originImg\"><i className=\"fas fa-map-marker-alt fa-2x\"></i></div>\n      <div className=\"origin\">\n        <Combobox onSelect={handleSelect}>\n          <ComboboxInput\n            value={value}\n            onChange={handleInput}\n            disabled={!ready}\n            placeholder=\"Location\"\n          />\n          <ComboboxPopover>\n            <ComboboxList>\n              {status === \"OK\" &&\n                data.map(({ id, description }) => (\n                  <ComboboxOption key={id} value={description} />\n                ))}\n            </ComboboxList>\n          </ComboboxPopover>\n        </Combobox>\n\n      </div>\n\n\n      <GoogleMap\n        id=\"map\"\n        mapContainerStyle={mapContainerStyle}\n        zoom={8}\n        center={center}\n        onClick={onMapClick}\n        onLoad={onMapLoad}\n      >\n\n        {markers.map((marker, index) => (\n          <Marker\n            key={index}\n            position={{ lat: marker.lat, lng: marker.lng }}\n            draggable={true}\n            onDragEnd={(e) => onMarkerDragEnd(e, index)}\n            onClick={(e) => onMarkerClick(e, index)}\n          />\n        ))}\n\n        {selected.map((select, index) => (select.active ? (\n\n          <InfoWindow\n            position={{ lat: select.lat, lng: select.lng }}\n            onCloseClick={(e) => onInfoClose(e, index)}\n          >\n            <div>\n              <h2>\n                <span role=\"img\" aria-label=\"bear\">\n                  <i className=\"fas fa-hands-helping\"></i>\n                </span>{\" \"}\n                Paragem na Rota\n              </h2>\n              <p>Escolhido {select.lat} , {select.lng}</p>\n            </div>\n          </InfoWindow>\n        ) : null))};\n            \n            <DirectionsRenderer directions={state.directions}  options={{\n           \n              suppressMarkers: true\n    \n            }} ></DirectionsRenderer>\n            \n      </GoogleMap>\n\n\n\n\n      <form className=\"details\" onSubmit={handleContinue}>\n        <div className=\"nameImg\"><i className=\"fas fa-signature fa-2x\"></i></div>\n        <div className=\"name\">\n          <input\n            placeholder=\"Events Name\"\n            type=\"text\"\n            name=\"eventsName\"\n            noValidate\n            onChange={e=>setEventsName(e.target.value)}\n          // values = {values}\n          />\n        </div>\n        <div className=\"timeImg\"><i className=\"fas fa-hourglass-half fa-2x\"></i></div>\n        <div className=\"time\">\n          <input\n            placeholder=\"Duration\"\n            type=\"time\"\n            name=\"time\"\n            noValidate\n            onChange={e => setTime(e.target.value)}\n          />\n        </div>\n        <div className=\"OImg\"><i className=\"far fa-dot-circle fa-2x\"></i></div>\n        <div className=\"orig\">\n          <input\n            placeholder=\"Event Location Beginning\"\n            type=\"text\"\n            name=\"origin\"\n            noValidate\n            onChange={e => setOrigin(e.target.value)}\n          />\n        </div>\n        <div className=\"Ocalendar\"><i className=\"far fa-calendar-alt fa-2x\"></i></div>\n        <div className=\"date\">\n          <input\n            placeholder=\"Event Date\"\n            type=\"datetime-local\"\n            name=\"date\"\n            noValidate\n            onChange={e => setDate(e.target.value)}\n          />\n        </div>\n       \n        <div className=\"DesImg\"><i className=\"fas fa-file-signature fa-2x\" ></i></div>\n        <div className=\"textArea\">\n          <textarea\n            name=\"description\"\n            placeholder=\"Event Descriprion\"\n            onChange={e => setDescription(e.target.value)}\n\n          /></div>\n        <MDBtn>\n          <MBtn type='submit'  onClick={handleOpen} >Create Event</MBtn>\n        </MDBtn>\n      </form>\n\n    \n     \n            \n      \n    </>\n  )\n};\n\nexport default CreateEvents\n\n"]},"metadata":{},"sourceType":"module"}